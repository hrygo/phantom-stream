# PhantomGuard ç”¨æˆ·æ‰‹å†Œ

**ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-12-05

---

## ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [å®‰è£…ä¸æ„å»º](#å®‰è£…ä¸æ„å»º)
3. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
4. [å‘½ä»¤å‚è€ƒ](#å‘½ä»¤å‚è€ƒ)
5. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¦‚è¿°

PhantomGuard æ˜¯ä¸€æ¬¾ PDF æ–‡ä»¶æ°´å°åµŒå…¥ä¸éªŒè¯å·¥å…·ï¼Œæ”¯æŒå¤šé”šç‚¹ç­¾åç­–ç•¥ï¼Œç”¨äºæ–‡æ¡£è¿½è¸ªä¸æƒåˆ©è¿½ç©¶åœºæ™¯ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **å¤šé”šç‚¹é˜²æŠ¤**: æ”¯æŒ Attachmentã€SMaskã€Contentã€Visual å››ç§é”šç‚¹ç»„åˆ
- **åŠ å¯†ç­¾å**: ä½¿ç”¨ AES-256-GCM åŠ å¯†ï¼Œç¡®ä¿ç­¾åä¸å¯ä¼ªé€ 
- **çµæ´»éªŒè¯**: Auto æ¨¡å¼ï¼ˆå¿«é€ŸéªŒè¯ï¼‰ä¸ All æ¨¡å¼ï¼ˆå®Œæ•´è¯Šæ–­ï¼‰
- **äº¤äº’å‹å¥½**: æ”¯æŒå‘½ä»¤è¡Œä¸äº¤äº’å¼ä¸¤ç§ä½¿ç”¨æ–¹å¼
- **ä¸€é”®éªŒè¯**: Lookup åŠŸèƒ½å¿«é€ŸéªŒè¯ä¸Šæ¬¡ç­¾åæ–‡ä»¶

### ç³»ç»Ÿè¦æ±‚

- æ“ä½œç³»ç»Ÿ: macOS, Linux, Windows
- Go ç‰ˆæœ¬: 1.24.0+ï¼ˆä»…æ„å»ºæ—¶éœ€è¦ï¼‰
- ä¾èµ–: æ— é¢å¤–ä¾èµ–ï¼ˆé™æ€ç¼–è¯‘äºŒè¿›åˆ¶ï¼‰

---

## å®‰è£…ä¸æ„å»º

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰

```bash
cd defender
make build
```

ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ä½äº `defender/bin/phantom-guard`ã€‚

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨ç¼–è¯‘

```bash
cd defender
go build -o bin/phantom-guard .
```

### å®‰è£…åˆ°ç³»ç»Ÿè·¯å¾„ï¼ˆå¯é€‰ï¼‰

```bash
cd defender
make install
```

å°†äºŒè¿›åˆ¶å®‰è£…åˆ° `/usr/local/bin/`ï¼Œä¹‹åå¯ç›´æ¥è¿è¡Œ `phantom-guard`ã€‚

---

## å¿«é€Ÿå¼€å§‹

### 1. ç­¾å PDF æ–‡ä»¶

```bash
./bin/phantom-guard sign \
  -f input.pdf \
  -m "UserID:Alice-2025" \
  -k "12345678901234567890123456789012"
```

**å‚æ•°è¯´æ˜**:
- `-f`: è¾“å…¥ PDF æ–‡ä»¶è·¯å¾„
- `-m`: è¦åµŒå…¥çš„æ¶ˆæ¯ï¼ˆè¿½è¸ªä¿¡æ¯ï¼‰
- `-k`: 32 å­—èŠ‚åŠ å¯†å¯†é’¥

**è¾“å‡º**: 
- ç­¾åæ–‡ä»¶: `input_signed.pdf`ï¼ˆä¸åŸæ–‡ä»¶åŒç›®å½•ï¼‰
- é»˜è®¤ä½¿ç”¨ Maximum ä¿æŠ¤çº§åˆ«ï¼ˆæ‰€æœ‰é”šç‚¹ï¼‰

### 2. éªŒè¯ç­¾åæ–‡ä»¶

```bash
./bin/phantom-guard verify \
  -f input_signed.pdf \
  -k "12345678901234567890123456789012"
```

**è¾“å‡º**: 
- éªŒè¯æˆåŠŸ: æ˜¾ç¤ºæå–çš„æ¶ˆæ¯
- éªŒè¯å¤±è´¥: æ˜¾ç¤ºé”™è¯¯åŸå› 

### 3. äº¤äº’å¼æ¨¡å¼

ç›´æ¥è¿è¡Œä¸å¸¦å‚æ•°å¯åŠ¨äº¤äº’ç•Œé¢:

```bash
./bin/phantom-guard
```

æä¾›ä¸‰ä¸ªåŠŸèƒ½èœå•ï¼š
1. **Protect PDF**: ç­¾åä¿æŠ¤æµç¨‹
2. **Verify PDF**: éªŒè¯æµç¨‹
3. **Lookup**: ä¸€é”®éªŒè¯ä¸Šæ¬¡ç­¾åæ–‡ä»¶ï¼ˆAll æ¨¡å¼ï¼‰

---

## å‘½ä»¤å‚è€ƒ

### `sign` - ç­¾åå‘½ä»¤

**ç”¨æ³•**:
```bash
phantom-guard sign -f <file> -m <message> -k <key>
```

**å¿…é€‰å‚æ•°**:
- `-f, --file`: PDF æ–‡ä»¶è·¯å¾„
- `-m, --msg`: åµŒå…¥æ¶ˆæ¯ï¼ˆå¦‚ "UserID:Bob"ï¼‰
- `-k, --key`: 32 å­—èŠ‚åŠ å¯†å¯†é’¥

**ç¤ºä¾‹**:

```bash
# åŸºç¡€ç­¾å
phantom-guard sign -f doc.pdf -m "Confidential-2025" -k "your-32-byte-key-here-12345678"
# ç”Ÿæˆ: doc_signed.pdf

# åµŒå…¥ç”¨æˆ·è¿½è¸ªä¿¡æ¯
phantom-guard sign -f doc.pdf -m "UserID:Alice" -k "your-key-32bytes-long-string!!"
# ç”Ÿæˆ: doc_signed.pdf
```

**ç­¾åç­–ç•¥**:
- é»˜è®¤ä½¿ç”¨ Maximum çº§åˆ«ï¼ˆAttachment + SMask + Content + Visualï¼‰
- å¦‚ PDF æ— å›¾åƒï¼ŒSMask è‡ªåŠ¨é™çº§
- Visual æ°´å°ä¸ºæ˜æ–‡éœ‡æ…‘ï¼Œä¸å‚ä¸éªŒè¯

---

### `verify` - éªŒè¯å‘½ä»¤

**ç”¨æ³•**:
```bash
phantom-guard verify -f <file> -k <key> [--mode <mode>]
```

**å¿…é€‰å‚æ•°**:
- `-f, --file`: ç­¾å PDF æ–‡ä»¶è·¯å¾„
- `-k, --key`: è§£å¯†å¯†é’¥ï¼ˆéœ€ä¸ç­¾åæ—¶ä¸€è‡´ï¼‰

**å¯é€‰å‚æ•°**:
- `--mode`: éªŒè¯æ¨¡å¼ï¼Œå¯é€‰ `auto` æˆ– `all`ï¼ˆé»˜è®¤ `auto`ï¼‰

**éªŒè¯æ¨¡å¼**:

#### Auto æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- å°è¯•æ‰€æœ‰é”šç‚¹ï¼Œé‡åˆ°ç¬¬ä¸€ä¸ªæˆåŠŸå³åœæ­¢
- å¿«é€ŸéªŒè¯ï¼Œé€‚åˆæ—¥å¸¸æ£€æŸ¥

```bash
phantom-guard verify -f signed.pdf -k "your-key"
```

#### All æ¨¡å¼
- é€ä¸€å°è¯•æ‰€æœ‰é”šç‚¹ï¼Œæ˜¾ç¤ºæ¯ä¸€æ­¥ç»“æœ
- å®Œæ•´è¯Šæ–­ï¼Œé€‚åˆè°ƒè¯•ä¸åˆ†æ

```bash
phantom-guard verify -f signed.pdf -k "your-key" --mode=all
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆAll æ¨¡å¼ï¼‰**:
```
ğŸ” Defender Verify Operation
   File: signed.pdf

 - Trying Attachment... OK
   Message(Attachment): UserID:Alice
 - Trying SMask... extract failed
 - Trying Content... OK
   Message(Content): UserID:Alice
âœ… Verification finished (mode=all).
```

---

### äº¤äº’æ¨¡å¼

**å¯åŠ¨**:
```bash
phantom-guard
```

**åŠŸèƒ½èœå•**:

#### 1. Protect PDF
å¼•å¯¼å¼ç­¾åæµç¨‹ï¼š
- Step 1: é€‰æ‹© PDF æ–‡ä»¶
- Step 2: è¾“å…¥æ¶ˆæ¯
- Step 3: è¾“å…¥å¯†é’¥ï¼ˆå¯å›è½¦è‡ªåŠ¨ç”Ÿæˆï¼‰
- Step 4: é€‰æ‹©ä¿æŠ¤çº§åˆ«
  - 1: Standardï¼ˆä»… Attachmentï¼‰
  - 2: Stealthï¼ˆAttachment + SMaskï¼‰
  - 3: Maximumï¼ˆå…¨éƒ¨é”šç‚¹ï¼‰- **é»˜è®¤**
  - 4: Customï¼ˆè‡ªå®šä¹‰ç»„åˆï¼‰

**æç¤º**: å›è½¦é‡‡ç”¨é»˜è®¤ Maximum ä¿æŠ¤çº§åˆ«ã€‚

#### 2. Verify PDF
å¼•å¯¼å¼éªŒè¯æµç¨‹ï¼š
- Step 1: é€‰æ‹©ç­¾å PDF æ–‡ä»¶
- Step 2: è¾“å…¥å¯†é’¥
- Step 3: é€‰æ‹©éªŒè¯æ¨¡å¼
  - 1: Autoï¼ˆé»˜è®¤ï¼‰
  - 2: Allï¼ˆé€é¡¹å±•å¼€ï¼‰

#### 3. Lookup
ä¸€é”®éªŒè¯ä¸Šæ¬¡ Protect çš„æ–‡ä»¶ï¼š
- è‡ªåŠ¨ä½¿ç”¨ä¸Šæ¬¡ç­¾åçš„æ–‡ä»¶è·¯å¾„ä¸å¯†é’¥
- ä»¥ All æ¨¡å¼é€é¡¹éªŒè¯æ‰€æœ‰é”šç‚¹
- æ— éœ€ä»»ä½•è¾“å…¥ï¼Œå¿«é€Ÿè¯Šæ–­

**æ³¨æ„**: é¦–æ¬¡è¿è¡Œæ—¶ Lookup ä¸å¯è§ï¼Œéœ€å…ˆæ‰§è¡Œä¸€æ¬¡ Protectã€‚

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: æ–‡æ¡£å‘å¸ƒè¿½è¸ª

ä¸ºå¯¹å¤–å‘å¸ƒçš„ PDF åµŒå…¥è¿½è¸ªä¿¡æ¯ï¼Œç”¨äºæº¯æºæ³„éœ²è´£ä»»ï¼š

```bash
# ç­¾å
phantom-guard sign -f report.pdf -m "Recipient:Customer-A-20251205" -k "your-secret-key-32bytes-long!!"

# å‘å¸ƒ report_signed.pdf

# å‘ç°æ³„éœ²åéªŒè¯
phantom-guard verify -f leaked_copy.pdf -k "your-secret-key-32bytes-long!!"
# è¾“å‡º: Recipient:Customer-A-20251205
```

### åœºæ™¯ 2: å¤šç‰ˆæœ¬æ–‡æ¡£ç®¡ç†

åœ¨ä¸åŒç‰ˆæœ¬æ–‡æ¡£ä¸­åµŒå…¥ç‰ˆæœ¬ä¿¡æ¯ï¼š

```bash
# ç‰ˆæœ¬ 1.0
phantom-guard sign -f contract.pdf -m "Version:1.0-20251205" -k "contract-key-32bytes-long-str!!"
# ç”Ÿæˆ: contract_signed.pdf

# ç‰ˆæœ¬ 2.0ï¼ˆæ‰‹åŠ¨é‡å‘½åè¾“å‡ºæ–‡ä»¶ä»¥åŒºåˆ†ç‰ˆæœ¬ï¼‰
phantom-guard sign -f contract_v2.pdf -m "Version:2.0-20251210" -k "contract-key-32bytes-long-str!!"
# ç”Ÿæˆ: contract_v2_signed.pdf

# éªŒè¯æŸç‰ˆæœ¬
phantom-guard verify -f contract_signed.pdf -k "contract-key-32bytes-long-str!!" --mode=all
```

### åœºæ™¯ 3: äº¤äº’å¼å¿«é€Ÿæ“ä½œ

é€‚åˆéæŠ€æœ¯äººå‘˜æˆ–ä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œåœºæ™¯ï¼š

```bash
# å¯åŠ¨äº¤äº’æ¨¡å¼
phantom-guard

# é€‰æ‹© 1: Protect PDF
# æ‹–æ‹½æ–‡ä»¶è·¯å¾„ï¼Œè¾“å…¥æ¶ˆæ¯ï¼Œå›è½¦ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆå¯†é’¥
# å›è½¦é‡‡ç”¨é»˜è®¤ Maximum ä¿æŠ¤

# é€‰æ‹© 3: Lookup å¿«é€ŸéªŒè¯
# æ— éœ€è¾“å…¥ï¼Œè‡ªåŠ¨è¯Šæ–­åˆšç­¾åçš„æ–‡ä»¶
```

### åœºæ™¯ 4: æ‰¹é‡éªŒè¯ï¼ˆè„šæœ¬é›†æˆï¼‰

```bash
#!/bin/bash
KEY="shared-secret-key-32bytes-long"

for file in signed_batch/*.pdf; do
  echo "Verifying: $file"
  phantom-guard verify -f "$file" -k "$KEY" || echo "FAILED: $file"
done
```

---

## å¸¸è§é—®é¢˜

### Q1: å¯†é’¥é•¿åº¦è¦æ±‚ï¼Ÿ

**A**: å¿…é¡»æ˜¯ 32 å­—èŠ‚ï¼ˆ32 ä¸ªå­—ç¬¦ï¼‰ã€‚è¿‡çŸ­æˆ–è¿‡é•¿ä¼šæŠ¥é”™ã€‚

ç¤ºä¾‹æœ‰æ•ˆå¯†é’¥:
- `12345678901234567890123456789012`
- `MySecretKey32BytesLongString!!`

### Q2: å¿˜è®°å¯†é’¥æ€ä¹ˆåŠï¼Ÿ

**A**: æ— æ³•æ¢å¤ã€‚ç­¾åé‡‡ç”¨ AES-256-GCM åŠ å¯†ï¼Œæ— å¯†é’¥æ— æ³•è§£å¯†ã€‚å»ºè®®ï¼š
- ä½¿ç”¨å¯†é’¥ç®¡ç†å·¥å…·ï¼ˆå¦‚ 1Passwordã€KeePassï¼‰
- ä¸ºé¡¹ç›®è®¾ç½®ç»Ÿä¸€å¯†é’¥å¹¶å¦¥å–„ä¿å­˜

### Q3: Visual æ°´å°å¯ä»¥éªŒè¯å—ï¼Ÿ

**A**: ä¸å¯ä»¥ã€‚Visual ä¸ºæ˜æ–‡éœ‡æ…‘æ°´å°ï¼Œä¸å‚ä¸è‡ªåŠ¨éªŒè¯ã€‚éªŒè¯ä¾èµ–åŠ å¯†é”šç‚¹ï¼ˆAttachment/SMask/Contentï¼‰ã€‚

### Q4: ç­¾ååæ–‡ä»¶å¤§å°å˜åŒ–ï¼Ÿ

**A**: é€šå¸¸ç•¥å¾®å‡å°æˆ–å‡ ä¹ä¸å˜ï¼ˆå¾—ç›Šäº pdfcpu ä¼˜åŒ–ï¼‰ã€‚å…¸å‹å˜åŒ–ï¼š-0.5% ~ +0.1%ã€‚

### Q5: All æ¨¡å¼ä¸ Auto æ¨¡å¼åŒºåˆ«ï¼Ÿ

**A**: 
- **Auto**: æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰æ•ˆé”šç‚¹å³åœæ­¢ï¼Œå¿«é€ŸéªŒè¯
- **All**: å°è¯•æ‰€æœ‰é”šç‚¹å¹¶é€é¡¹æ˜¾ç¤ºç»“æœï¼Œç”¨äºè¯Šæ–­ä¸è°ƒè¯•

### Q6: çº¯æ–‡æœ¬ PDFï¼ˆæ— å›¾åƒï¼‰å¯ä»¥ç­¾åå—ï¼Ÿ

**A**: å¯ä»¥ã€‚SMask é”šç‚¹ä¼šè‡ªåŠ¨é™çº§ï¼Œä½¿ç”¨ Attachment + Content é”šç‚¹ã€‚

### Q7: å¦‚ä½•æŸ¥çœ‹å·²ç­¾åæ–‡ä»¶çš„é”šç‚¹çŠ¶æ€ï¼Ÿ

**A**: ä½¿ç”¨ `--mode=all` éªŒè¯æ¨¡å¼ï¼š

```bash
phantom-guard verify -f signed.pdf -k "your-key" --mode=all
```

ä¼šæ˜¾ç¤ºæ¯ä¸ªé”šç‚¹çš„æå–ä¸è§£å¯†ç»“æœã€‚

### Q8: äº¤äº’æ¨¡å¼ä¸­çš„ Lookup çœ‹ä¸åˆ°ï¼Ÿ

**A**: Lookup ä»…åœ¨æ‰§è¡Œè¿‡ä¸€æ¬¡ Protect åå‡ºç°ã€‚é¦–æ¬¡è¿è¡Œæ—¶èœå•åªæœ‰ï¼š
- 1: Protect PDF
- 2: Verify PDF
- 3: Exit

å®Œæˆä¸€æ¬¡ç­¾ååï¼ŒLookup ä¼šè‡ªåŠ¨å‡ºç°åœ¨èœå•ã€‚

### Q9: è¾“å‡ºæ–‡ä»¶åè§„åˆ™ï¼Ÿ

**A**: 
ç­¾ååçš„æ–‡ä»¶ç»Ÿä¸€ä½¿ç”¨ `åŸæ–‡ä»¶å_signed.pdf` æ ¼å¼ã€‚

ç¤ºä¾‹:
- `report.pdf` â†’ `report_signed.pdf`
- `contract.pdf` â†’ `contract_signed.pdf`

### Q10: å¯ä»¥ä¿®æ”¹é»˜è®¤ä¿æŠ¤çº§åˆ«å—ï¼Ÿ

**A**: å‘½ä»¤è¡Œæ¨¡å¼é»˜è®¤ä½¿ç”¨ Maximumã€‚äº¤äº’æ¨¡å¼å¯åœ¨ Step 4 é€‰æ‹©æˆ–å›è½¦é»˜è®¤ Maximumã€‚

---

## æŠ€æœ¯æ”¯æŒ

- **é¡¹ç›®æ–‡æ¡£**: `defender/docs/`
- **æŠ€æœ¯é™„å½•**: `defender/docs/Defender_Official_Report_Attr.md`
- **æµ‹è¯•ç”¨ä¾‹**: `defender/injector/*_test.go`

---

**ç‰ˆæƒæ‰€æœ‰ Â© 2025 PhantomStream Defense Team**
